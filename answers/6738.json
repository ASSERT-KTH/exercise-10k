{
  "prompt": "Write a program that throttles input data to prevent overwhelming the system",
  "answer": "**Throttling Program**\n=======================\n\nThis program uses a token bucket algorithm to throttle input data and prevent overwhelming the system.\n\n### Requirements\n\n* Python 3.6+\n* `time` and `threading` modules\n\n### Code\n```python\nimport time\nimport threading\nfrom queue import Queue\n\nclass TokenBucket:\n    def __init__(self, rate, capacity):\n        \"\"\"\n        Initialize the token bucket.\n\n        :param rate: The rate at which tokens are added to the bucket (tokens per second)\n        :param capacity: The maximum capacity of the bucket (tokens)\n        \"\"\"\n        self.rate = rate\n        self.capacity = capacity\n        self.tokens = capacity\n        self.last_update = time.time()\n\n    def get_token(self):\n        \"\"\"\n        Get a token from the bucket.\n\n        :return: True if a token is available, False otherwise\n        \"\"\"\n        current_time = time.time()\n        elapsed_time = current_time - self.last_update\n        self.last_update = current_time\n\n        # Add tokens to the bucket based on the elapsed time\n        self.tokens = min(self.capacity, self.tokens + elapsed_time * self.rate)\n\n        if self.tokens >= 1:\n            self.tokens -= 1\n            return True\n        else:\n            return False\n\n\nclass Throttler:\n    def __init__(self, rate, capacity):\n        \"\"\"\n        Initialize the throttler.\n\n        :param rate: The rate at which data is allowed to be processed (items per second)\n        :param capacity: The maximum capacity of the bucket (items)\n        \"\"\"\n        self.token_bucket = TokenBucket(rate, capacity)\n        self.queue = Queue()\n\n    def add_data(self, data):\n        \"\"\"\n        Add data to the throttler.\n\n        :param data: The data to be processed\n        \"\"\"\n        self.queue.put(data)\n\n    def process_data(self):\n        \"\"\"\n        Process the data in the throttler.\n        \"\"\"\n        while True:\n            data = self.queue.get()\n            if self.token_bucket.get_token():\n                # Process the data\n                print(f\"Processing data: {data}\")\n                time.sleep(0.1)  # Simulate processing time\n            else:\n                print(\"Throttling: No tokens available\")\n                time.sleep(0.1)  # Wait for more tokens to be available\n            self.queue.task_done()\n\n\ndef main():\n    # Create a throttler with a rate of 5 items per second and a capacity of 10 items\n    throttler = Throttler(5, 10)\n\n    # Create a thread to process the data\n    thread = threading.Thread(target=throttler.process_data)\n    thread.daemon = True\n    thread.start()\n\n    # Add data to the throttler\n    for i in range(100):\n        throttler.add_data(i)\n        time.sleep(0.01)  # Simulate incoming data\n\n    # Wait for all data to be processed\n    throttler.queue.join()\n\n\nif __name__ == \"__main__\":\n    main()\n```\n\n### Explanation\n\n1. The `TokenBucket` class implements the token bucket algorithm. It has a `rate` parameter that determines how quickly tokens are added to the bucket, and a `capacity` parameter that determines the maximum number of tokens in the bucket.\n2. The `Throttler` class uses the `TokenBucket` class to throttle input data. It has a `queue` attribute that stores the data to be processed, and a `process_data` method that processes the data in the queue.\n3. The `process_data` method runs in a separate thread and continuously checks the queue for new data. If a token is available, it processes the data and waits for a short time to simulate processing time. If no tokens are available, it waits for more tokens to be available before processing the data.\n4. In the `main` function, we create a throttler with a rate of 5 items per second and a capacity of 10 items. We then create a thread to process the data and add data to the throttler at a rate of 100 items per second.\n\n### Example Use Case\n\nThis program can be used to throttle input data in a variety of scenarios, such as:\n\n* Limiting the number of requests to a web server to prevent overwhelming it\n* Throttling the rate at which data is written to a database to prevent performance issues\n* Limiting the number of messages sent to a messaging queue to prevent overwhelming the queue\n\nNote that the `time.sleep` calls in the program are used to simulate processing time and can be removed or modified to suit the specific use case.",
  "timestamp": "2026-02-11T20:16:20.522512",
  "model": "RedHatAI/Llama-3.3-70B-Instruct-FP8-dynamic"
}