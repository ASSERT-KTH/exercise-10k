{
  "prompt": "Aggregate a dictionary by a common key.",
  "answer": "### Aggregating a Dictionary by a Common Key\n\nYou can aggregate a dictionary by a common key using Python's built-in `itertools` and `dict` functions, or by utilizing the `pandas` library for more complex aggregations.\n\n#### Using Dict and List Comprehension\n\nHere's an example of how you can aggregate a dictionary by a common key using dict and list comprehension:\n\n```python\n# Sample dictionary\ndata = [\n    {'id': 1, 'name': 'John', 'age': 25},\n    {'id': 1, 'name': 'John', 'city': 'New York'},\n    {'id': 2, 'name': 'Jane', 'age': 30},\n    {'id': 2, 'name': 'Jane', 'city': 'Chicago'}\n]\n\n# Aggregate the dictionary by 'id'\naggregated_data = {}\nfor item in data:\n    if item['id'] not in aggregated_data:\n        aggregated_data[item['id']] = {}\n    aggregated_data[item['id']].update({k: v for k, v in item.items() if k != 'id'})\n\nprint(aggregated_data)\n```\n\n#### Using Pandas\n\nAlternatively, you can use the `pandas` library to aggregate the dictionary. Here's an example:\n\n```python\nimport pandas as pd\n\n# Sample dictionary\ndata = [\n    {'id': 1, 'name': 'John', 'age': 25},\n    {'id': 1, 'name': 'John', 'city': 'New York'},\n    {'id': 2, 'name': 'Jane', 'age': 30},\n    {'id': 2, 'name': 'Jane', 'city': 'Chicago'}\n]\n\n# Convert the dictionary to a pandas DataFrame\ndf = pd.DataFrame(data)\n\n# Aggregate the DataFrame by 'id'\naggregated_df = df.groupby('id').agg(lambda x: x.dropna().tolist())\n\nprint(aggregated_df)\n```\n\nHowever, this will create a DataFrame with lists as values, which might not be what you want.\n\nTo avoid this, you can use the `groupby` function along with a custom function to aggregate the data:\n\n```python\nimport pandas as pd\n\n# Sample dictionary\ndata = [\n    {'id': 1, 'name': 'John', 'age': 25},\n    {'id': 1, 'name': 'John', 'city': 'New York'},\n    {'id': 2, 'name': 'Jane', 'age': 30},\n    {'id': 2, 'name': 'Jane', 'city': 'Chicago'}\n]\n\n# Convert the dictionary to a pandas DataFrame\ndf = pd.DataFrame(data)\n\n# Define a custom function to aggregate the data\ndef aggregate_data(group):\n    aggregated_data = {}\n    for index, row in group.iterrows():\n        for column, value in row.items():\n            if column != 'id':\n                aggregated_data[column] = value\n    return aggregated_data\n\n# Aggregate the DataFrame by 'id'\naggregated_df = df.groupby('id').apply(aggregate_data)\n\nprint(aggregated_df)\n```\n\nNote that this will overwrite any existing values for a given key. If you want to keep all values, you can modify the `aggregate_data` function to store them in a list.",
  "timestamp": "2026-02-11T08:22:44.997165",
  "model": "RedHatAI/Llama-3.3-70B-Instruct-FP8-dynamic"
}