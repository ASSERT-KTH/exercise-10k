{
  "prompt": "Write a function that returns a closure with a context manager",
  "answer": "### Closure with Context Manager Function\n#### Overview\nThis function returns a closure that implements a context manager. The context manager is used to manage resources, such as files or database connections, and ensures that they are properly cleaned up after use.\n\n#### Code\n```python\nfrom contextlib import contextmanager\nfrom typing import Callable\n\ndef create_closure_context_manager(resource_name: str) -> Callable:\n    \"\"\"\n    Returns a closure that implements a context manager.\n    \n    The context manager is used to manage resources, such as files or database connections,\n    and ensures that they are properly cleaned up after use.\n    \n    Args:\n        resource_name (str): The name of the resource being managed.\n    \n    Returns:\n        Callable: A closure that implements a context manager.\n    \"\"\"\n\n    # Initialize a variable to store the resource\n    resource = None\n\n    @contextmanager\n    def closure_context_manager():\n        nonlocal resource  # Use the nonlocal keyword to modify the variable from the outer scope\n        \n        # Acquire the resource\n        try:\n            print(f\"Acquiring resource: {resource_name}\")\n            resource = f\"Resource {resource_name}\"\n            yield resource  # Yield the resource to the caller\n        finally:\n            # Release the resource\n            if resource is not None:\n                print(f\"Releasing resource: {resource_name}\")\n                resource = None\n\n    return closure_context_manager\n\n\n# Example usage:\nif __name__ == \"__main__\":\n    # Create a closure with a context manager\n    context_manager = create_closure_context_manager(\"example\")\n\n    # Use the context manager to manage a resource\n    with context_manager() as resource:\n        print(f\"Using resource: {resource}\")\n```\n\n#### Explanation\n\n1.  The `create_closure_context_manager` function takes a `resource_name` parameter and returns a closure that implements a context manager using the `@contextmanager` decorator.\n2.  The `closure_context_manager` function is defined inside `create_closure_context_manager` and has access to the `resource_name` variable from the outer scope.\n3.  The `closure_context_manager` function uses a `try`-`finally` block to acquire and release the resource. The `yield` statement is used to yield the resource to the caller.\n4.  In the example usage, a closure with a context manager is created using `create_closure_context_manager`. The context manager is then used to manage a resource within a `with` statement, ensuring that the resource is properly cleaned up after use.\n\n#### Advice\n\n*   Use context managers to manage resources that require cleanup, such as files, database connections, or locks.\n*   The `@contextmanager` decorator provides a convenient way to implement context managers without having to define a separate class.\n*   When using a closure with a context manager, ensure that the closure has access to the necessary variables and resources from the outer scope.",
  "timestamp": "2026-02-11T23:24:19.998460",
  "model": "RedHatAI/Llama-3.3-70B-Instruct-FP8-dynamic"
}