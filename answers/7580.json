{
  "prompt": "Write a function that uses security features such as encryption or authentication to provide secure functionality.",
  "answer": "**Secure Authentication Function**\n=====================================\n\nBelow is an example of a Python function that uses security features such as hashing and salting for password authentication.\n\n### Requirements\n\n* Python 3.8+\n* `hashlib` library for hashing\n* `secrets` library for generating random salts\n* `hmac` library for generating authentication tokens\n\n### Code\n\n```python\nimport hashlib\nimport secrets\nimport hmac\n\ndef generate_password_hash(password):\n    \"\"\"\n    Generate a password hash with a random salt.\n\n    Args:\n        password (str): The password to be hashed.\n\n    Returns:\n        str: A string containing the salt and hashed password.\n    \"\"\"\n    salt = secrets.token_bytes(16)\n    hashed_password = hashlib.pbkdf2_hmac('sha256', password.encode('utf-8'), salt, 100000)\n    return salt.hex() + ':' + hashed_password.hex()\n\ndef verify_password(password, password_hash):\n    \"\"\"\n    Verify a password against a password hash.\n\n    Args:\n        password (str): The password to be verified.\n        password_hash (str): The password hash to verify against.\n\n    Returns:\n        bool: True if the password is valid, False otherwise.\n    \"\"\"\n    salt, hashed_password = password_hash.split(':')\n    salt = bytes.fromhex(salt)\n    hashed_input = hashlib.pbkdf2_hmac('sha256', password.encode('utf-8'), salt, 100000)\n    return hmac.compare_digest(hashed_password, hashed_input.hex())\n\ndef generate_auth_token(username):\n    \"\"\"\n    Generate an authentication token for a user.\n\n    Args:\n        username (str): The username to generate the token for.\n\n    Returns:\n        str: The authentication token.\n    \"\"\"\n    secret_key = secrets.token_bytes(32)\n    token = hmac.new(secret_key, username.encode('utf-8'), 'sha256').hexdigest()\n    return token\n\ndef verify_auth_token(token, username):\n    \"\"\"\n    Verify an authentication token for a user.\n\n    Args:\n        token (str): The token to verify.\n        username (str): The username to verify the token for.\n\n    Returns:\n        bool: True if the token is valid, False otherwise.\n    \"\"\"\n    secret_key = secrets.token_bytes(32)\n    expected_token = hmac.new(secret_key, username.encode('utf-8'), 'sha256').hexdigest()\n    return hmac.compare_digest(token, expected_token)\n\n# Example usage\nif __name__ == \"__main__\":\n    password = \"mysecretpassword\"\n    password_hash = generate_password_hash(password)\n    print(\"Password Hash:\", password_hash)\n\n    is_valid = verify_password(password, password_hash)\n    print(\"Is Password Valid?\", is_valid)\n\n    username = \"john_doe\"\n    auth_token = generate_auth_token(username)\n    print(\"Auth Token:\", auth_token)\n\n    is_token_valid = verify_auth_token(auth_token, username)\n    print(\"Is Auth Token Valid?\", is_token_valid)\n```\n\n### Explanation\n\n1. The `generate_password_hash` function generates a password hash with a random salt using the PBKDF2-HMAC algorithm.\n2. The `verify_password` function verifies a password against a password hash by re-hashing the input password with the same salt and comparing the resulting hashes.\n3. The `generate_auth_token` function generates an authentication token for a user using the HMAC algorithm with a secret key.\n4. The `verify_auth_token` function verifies an authentication token for a user by re-generating the token with the same secret key and comparing the resulting tokens.\n\nNote that in a real-world application, you should store the password hashes and authentication tokens securely, such as in a database with proper access controls. Additionally, you should use a secure random number generator to generate the salts and secret keys.",
  "timestamp": "2026-02-11T21:55:43.978604",
  "model": "RedHatAI/Llama-3.3-70B-Instruct-FP8-dynamic"
}