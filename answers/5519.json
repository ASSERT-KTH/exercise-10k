{
  "prompt": "Write a program to find the maximum flow of a flow network using the Edmonds-Karp algorithm.",
  "answer": "Here is a Python implementation of the Edmonds-Karp algorithm for finding the maximum flow in a flow network. The algorithm uses a breadth-first search (BFS) to find an augmenting path in the residual graph.\n\n```python\nfrom collections import deque\n\ndef bfs(rGraph, s, t, parent):\n    \"\"\"\n    Performs a BFS traversal of the residual graph to find an augmenting path.\n\n    Args:\n    rGraph (list): The residual graph.\n    s (int): The source node.\n    t (int): The sink node.\n    parent (list): A list to store the parent of each node in the augmenting path.\n\n    Returns:\n    bool: True if an augmenting path is found, False otherwise.\n    \"\"\"\n    visited = [False] * len(rGraph)\n    queue = deque()\n\n    queue.append(s)\n    visited[s] = True\n\n    while queue:\n        u = queue.popleft()\n\n        for ind, val in enumerate(rGraph[u]):\n            if not visited[ind] and val > 0:\n                queue.append(ind)\n                visited[ind] = True\n                parent[ind] = u\n\n                if ind == t:\n                    return True\n\n    return False\n\n\ndef edmonds_karp(graph, source, sink):\n    \"\"\"\n    Finds the maximum flow in a flow network using the Edmonds-Karp algorithm.\n\n    Args:\n    graph (list): The flow network.\n    source (int): The source node.\n    sink (int): The sink node.\n\n    Returns:\n    int: The maximum flow.\n    \"\"\"\n    parent = [-1] * len(graph)\n    max_flow = 0\n    rGraph = [i[:] for i in graph]\n\n    while bfs(rGraph, source, sink, parent):\n        path_flow = float(\"Inf\")\n        s = sink\n\n        while s != source:\n            path_flow = min(path_flow, rGraph[parent[s]][s])\n            s = parent[s]\n\n        max_flow += path_flow\n\n        v = sink\n        while v != source:\n            u = parent[v]\n            rGraph[u][v] -= path_flow\n            rGraph[v][u] += path_flow\n            v = parent[v]\n\n    return max_flow\n\n\n# Example usage:\ngraph = [[0, 16, 13, 0, 0, 0],\n         [0, 0, 10, 12, 0, 0],\n         [0, 4, 0, 0, 14, 0],\n         [0, 0, 9, 0, 0, 20],\n         [0, 0, 0, 7, 0, 4],\n         [0, 0, 0, 0, 0, 0]]\n\nsource = 0\nsink = 5\n\nprint(\"The maximum possible flow is %d \" % edmonds_karp(graph, source, sink))\n```\n\nIn this program, we define two functions: `bfs` for finding an augmenting path in the residual graph and `edmonds_karp` for finding the maximum flow using the Edmonds-Karp algorithm.\n\nThe `bfs` function takes the residual graph, source node, sink node, and a list to store the parent of each node in the augmenting path as input. It performs a BFS traversal to find an augmenting path and returns True if such a path is found, False otherwise.\n\nThe `edmonds_karp` function takes the flow network, source node, and sink node as input. It initializes the residual graph, parent list, and maximum flow. Then, it repeatedly finds an augmenting path in the residual graph using BFS and updates the residual graph and maximum flow until no more augmenting paths can be found. Finally, it returns the maximum flow.\n\nIn the example usage, we define a flow network represented as an adjacency matrix and find the maximum flow using the Edmonds-Karp algorithm. The output will be the maximum possible flow in the flow network.",
  "timestamp": "2026-02-11T15:27:31.258547",
  "model": "RedHatAI/Llama-3.3-70B-Instruct-FP8-dynamic"
}