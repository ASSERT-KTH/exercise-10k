{
  "prompt": "Write a function to schedule tasks on multiple machines to minimize the makespan.",
  "answer": "**Scheduling Tasks on Multiple Machines**\n=====================================================\n\nIn this solution, we'll implement a function to schedule tasks on multiple machines to minimize the makespan. We'll use a greedy algorithm to assign tasks to the machine with the earliest end time.\n\n**Code**\n--------\n\n```python\nimport heapq\n\ndef schedule_tasks(tasks, machines):\n    \"\"\"\n    Schedule tasks on multiple machines to minimize the makespan.\n\n    Args:\n    tasks (list): A list of task durations.\n    machines (int): The number of machines.\n\n    Returns:\n    list: A list of machine schedules, where each schedule is a list of task durations.\n    \"\"\"\n    # Initialize machine schedules with end times\n    machine_schedules = [[] for _ in range(machines)]\n    machine_end_times = [0] * machines\n\n    # Sort tasks by duration in descending order\n    tasks.sort(reverse=True)\n\n    # Assign tasks to machines\n    for task in tasks:\n        # Find the machine with the earliest end time\n        machine_idx = machine_end_times.index(min(machine_end_times))\n        machine_schedules[machine_idx].append(task)\n        machine_end_times[machine_idx] += task\n\n    return machine_schedules\n\ndef calculate_makespan(machine_schedules):\n    \"\"\"\n    Calculate the makespan of a machine schedule.\n\n    Args:\n    machine_schedules (list): A list of machine schedules, where each schedule is a list of task durations.\n\n    Returns:\n    int: The makespan of the machine schedule.\n    \"\"\"\n    return max(sum(schedule) for schedule in machine_schedules)\n\n# Example usage\ntasks = [5, 2, 8, 3, 1, 6, 4]\nmachines = 3\nmachine_schedules = schedule_tasks(tasks, machines)\nmakespan = calculate_makespan(machine_schedules)\n\nprint(\"Machine Schedules:\")\nfor i, schedule in enumerate(machine_schedules):\n    print(f\"Machine {i+1}: {schedule}\")\n\nprint(f\"Makespan: {makespan}\")\n```\n\n**Explanation**\n---------------\n\n1.  Initialize machine schedules with end times.\n2.  Sort tasks by duration in descending order.\n3.  Assign tasks to machines using a greedy algorithm:\n    *   Find the machine with the earliest end time.\n    *   Assign the task to that machine and update its end time.\n4.  Calculate the makespan of the machine schedule by finding the maximum sum of task durations across all machines.\n\n**Time Complexity**\n------------------\n\n*   The `schedule_tasks` function has a time complexity of O(n log n) due to the sorting of tasks.\n*   The `calculate_makespan` function has a time complexity of O(m), where m is the number of machines.\n\n**Space Complexity**\n-------------------\n\n*   The `schedule_tasks` function has a space complexity of O(n + m), where n is the number of tasks and m is the number of machines.\n*   The `calculate_makespan` function has a space complexity of O(1), as it only uses a constant amount of space to store the makespan.",
  "timestamp": "2026-02-10T15:04:53.042763",
  "model": "RedHatAI/Llama-3.3-70B-Instruct-FP8-dynamic"
}