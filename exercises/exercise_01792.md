## Exercise
Write a function to flatten a nested dictionary and return a new dictionary containing all key-value pairs at the top level.

## Reference Solution
```python
def flatten_dict(nested_dict, prefix=''):
    """
    Flattens a nested dictionary and returns a new dictionary containing all key-value pairs at the top level.

    Args:
    - nested_dict (dict): The dictionary to be flattened.
    - prefix (str): Optional prefix for the flattened dictionary keys. Defaults to an empty string.

    Returns:
    - dict: A new dictionary containing all key-value pairs at the top level.
    """
    flattened_dict = {}
    for key, value in nested_dict.items():
        new_key = f"{prefix}{key}" if not prefix else f"{prefix}.{key}"
        if isinstance(value, dict):
            # Recursively flatten nested dictionaries
            flattened_dict.update(flatten_dict(value, new_key))
        else:
            # Add key-value pairs to the flattened dictionary
            flattened_dict[new_key] = value
    return flattened_dict

# Example usage:
if __name__ == "__main__":
    nested_dict = {
        "a": 1,
        "b": 2,
        "c": {
            "d": 3,
            "e": 4,
            "f": {
                "g": 5,
                "h": 6
            }
        }
    }

    flattened_dict = flatten_dict(nested_dict)
    print(flattened_dict)
```

```python
{
    'a': 1, 
    'b': 2, 
    'c.d': 3, 
    'c.e': 4, 
    'c.f.g': 5, 
    'c.f.h': 6
}
```

## Generated Output
```
{'a': 1, 'b': 2, 'c.d': 3, 'c.e': 4, 'c.f.g': 5, 'c.f.h': 6}
```

generated by python 3.10.13

solution generated by RedHatAI/Llama-3.3-70B-Instruct-FP8-dynamic
