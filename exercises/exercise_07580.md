## Exercise
Write a function that uses security features such as encryption or authentication to provide secure functionality.

## Reference Solution
```python
import hashlib
import secrets
import hmac

def generate_password_hash(password):
    """
    Generate a password hash with a random salt.

    Args:
        password (str): The password to be hashed.

    Returns:
        str: A string containing the salt and hashed password.
    """
    salt = secrets.token_bytes(16)
    hashed_password = hashlib.pbkdf2_hmac('sha256', password.encode('utf-8'), salt, 100000)
    return salt.hex() + ':' + hashed_password.hex()

def verify_password(password, password_hash):
    """
    Verify a password against a password hash.

    Args:
        password (str): The password to be verified.
        password_hash (str): The password hash to verify against.

    Returns:
        bool: True if the password is valid, False otherwise.
    """
    salt, hashed_password = password_hash.split(':')
    salt = bytes.fromhex(salt)
    hashed_input = hashlib.pbkdf2_hmac('sha256', password.encode('utf-8'), salt, 100000)
    return hmac.compare_digest(hashed_password, hashed_input.hex())

def generate_auth_token(username):
    """
    Generate an authentication token for a user.

    Args:
        username (str): The username to generate the token for.

    Returns:
        str: The authentication token.
    """
    secret_key = secrets.token_bytes(32)
    token = hmac.new(secret_key, username.encode('utf-8'), 'sha256').hexdigest()
    return token

def verify_auth_token(token, username):
    """
    Verify an authentication token for a user.

    Args:
        token (str): The token to verify.
        username (str): The username to verify the token for.

    Returns:
        bool: True if the token is valid, False otherwise.
    """
    secret_key = secrets.token_bytes(32)
    expected_token = hmac.new(secret_key, username.encode('utf-8'), 'sha256').hexdigest()
    return hmac.compare_digest(token, expected_token)

# Example usage
if __name__ == "__main__":
    password = "mysecretpassword"
    password_hash = generate_password_hash(password)
    print("Password Hash:", password_hash)

    is_valid = verify_password(password, password_hash)
    print("Is Password Valid?", is_valid)

    username = "john_doe"
    auth_token = generate_auth_token(username)
    print("Auth Token:", auth_token)

    is_token_valid = verify_auth_token(auth_token, username)
    print("Is Auth Token Valid?", is_token_valid)
```

## Generated Output
```
Password Hash: 9c2ff985c859ccdec5bb6651def4e815:b782afb7184f6c65493534092434d0765c954e9632d6ee7c582a724eb5fbfe91
Is Password Valid? True
Auth Token: 2241ca68b2d2d6c30a530d6afd79cbe468f98f57864580af5a97b3a6e50fde46
Is Auth Token Valid? False
```

generated by python 3.10.13

solution generated by RedHatAI/Llama-3.3-70B-Instruct-FP8-dynamic
